PROCESS
	* Parse STIX XML file looking for stix:Indicator
	* Parse Indicator <stix:Indicator>	
		* Create a list of URL
			<indicator:Observable>
				<cybox:Object>
					<cybox:Properties type="URL">
						<URIObj:Value condition="Equals"> inform.bedircati.com  </URIObj:Value>
			AND
			<indicator:Kill_Chain_Phases>
				<stixCommon:Kill_Chain_Phase name="Command and Control"    />

		* Create a list of Emails
			<indicator:Observable>
				<cybox:Object>
					<cybox:Properties xsi:type="EmailMessageObj:EmailMessageObjectType">
						<EmailMessageObj:Header>
							<EmailMessageObj:Sender category="e-mail">
								<AddrObj:Address_Value condition="Equals">nick.macpherson.uk@gmail.com</AddrObj:Address_Value>
			AND
				<indicator:Kill_Chain_Phases>
					<stixCommon:Kill_Chain_Phase name="Command and Control"    />
				OR
				<indicator:Kill_Chain_Phases>
					<stixCommon:Kill_Chain_Phase name="Delivery"    />
		* NOTE: Additional emails may be under Related Objects
				<cybox:Related_Objects>
					<cybox:Related_Object
						<cybox:Properties xsi:type="EmailMessageObj:EmailMessageObjectType">
							<EmailMessageObj:Header>
								<EmailMessageObj:Sender category="e-mail">
									<AddrObj:Address_Value condition="Equals">vilkura1@gmail.com</AddrObj:Address_Value>
		* NOTE: Spoofed emails should not be added
			<indicator:Observable>
				<cybox:Object>
					<cybox:Properties xsi:type="EmailMessageObj:EmailMessageObjectType">
						<EmailMessageObj:Header>
							<EmailMessageObj:Sender category="e-mail">
				                <cyboxCommon:Custom_Properties>
				                	<cyboxCommon:Property name="is_spoofed">true</cyboxCommon:Property>

		* Create a list of URIs that are C2 OR Delivery OR Exploitation
		* These may contain Addresses and Domain Names
			<indicator:Observable>
				<cybox:Object>
		          <cybox:Properties type="Domain Name" xsi:type="URIObj:URIObjectType">
		            <URIObj:Value condition="Equals">product.sorgerealty.com</URIObj:Value>
		          <cybox:Related_Objects>
		            <cybox:Related_Object id="NCCIC:Object-7ab86978-60af-41fd-9c23-48a6d4a2257d">
		              <cybox:Properties category="ipv4-addr" xsi:type="AddrObj:AddressObjectType">
		                <AddrObj:Address_Value condition="Equals">12.229.71.10</AddrObj:Address_Value>
            AND
    	      <indicator:Kill_Chain_Phases>
				<stixCommon:Kill_Chain_Phase name="Exploitation" />
            	
            
			

								
		* Create a list of URLs that are C2 OR Delivery
			<indicator:Observable>
				<cybox:Object>
					<cybox:Properties category="ipv4-addr">
						<AddrObj:Address_Value condition="Equals">122.49.215.108</AddrObj:Address_Value>
			AND
				<indicator:Kill_Chain_Phases>
					<stixCommon:Kill_Chain_Phase name="Command and Control"    />
				OR
				<indicator:Kill_Chain_Phases>
					<stixCommon:Kill_Chain_Phase name="Delivery"    />
					
		* NOTE: Additional IPs may be under Related Objects
			<cybox:Related_Objects>
	         	<cybox:Related_Object id="NCCIC:Object-b94e098e-1681-4ac3-92e7-7b3628340664">
	           		<cybox:Properties category="ipv4-addr" xsi:type="AddrObj:AddressObjectType">
						<AddrObj:Address_Value condition="Equals">198.23.143.81</AddrObj:Address_Value>
						
						
						

	* There are URL within the Email Message object.  Those should be collected as well.
	      <indicator:Observable>
	        <cybox:Object >
	          <cybox:Properties xsi:type="EmailMessageObj:EmailMessageObjectType">
	          <cybox:Related_Objects>
	            <cybox:Related_Object>
	              <cybox:Properties type="URL">
	                <URIObj:Value condition="Equals">http://web.neonbilisim.com/tag/Uid.php?reg=[redacted]</URIObj:Value>
		
	* 
            <indicator:Related_Indicators scope="exclusive">
                <indicator:Related_Indicator>
                    <stixCommon:Relationship>Connected_From</stixCommon:Relationship>	
	
				
	* Parse URL List
		* Strip out the port :XXX
		* Strip out the http:// header
		* Strip out the trailing stuff xxx.xxx.xxx.xxx/stuff
		* Remove braces
					
	* Parse the Emails:
		* only keep the email <email@email.com>
		* Check with admins on blocking eail domains or remove [various]@emaildomain.com
		
	* Sanity check and remove from list:
		* google IP addresses
		* smtp google/yahoo
		* url shortening ow.ly
		* Check for multiple values in the URIObject files (20067)
		
		
		

Interesting observations:
	A file may contain an IP address that isn't a part of the kill chain.  Should they be included in the blocked list? At this point I don't think that they should.
	
	



Things that are of interest

The following contain email addresses.  Could be sub-search of:
Email Message -> Header -> Sender[category=email] -> Address_Value [condition=Equals]

*  Indicator Composition -> OR -> Observable
	* Email Message -> Header -> Sender[category=email] -> Address_Value [condition=Equals]
	* Email Message -> Related Objects -> Relationship: Contains -> Email Message -> Header -> Sender[category=email] -> Address_Value [condition=Equals]


The following contains IP address.  These would need to be reverse IP lookup. Since there isn't an indication 
that these are C2 or particularly dangerous.

*  Indicator Composition -> OR -> Observable
	* Email Message -> Related Objects -> Relationship: Contains -> Address -> Address_Value
	
The following are C2 which should be blocked:
*  Indicator Composition ->
	-> Description -> "C2 IP address"
	-> Observable -> Address [category=ipv4-addr] -> Address_Value [condition=Equals] -> <IP ADDRESS>
 
 * Indicator Composition
 	-> Kill Chain Phases -> Command and Control -> Kill Chain Phase 
 		-> Name = "Command and Control"
 		-> Ordinality = "6"
 	AND
 	 	-> Observable -> Link [type=URL] -> Value [condition=Equals] = <DOMAIN NAME>
 		OR 
 	 	-> Observable -> Link [type=ipv4-addr] -> Value [condition=Equals] = <IP Address>
 		